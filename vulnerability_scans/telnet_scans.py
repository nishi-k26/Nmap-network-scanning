#!/usr/bin/python3

import subprocess
from fpdf import FPDF

def perform_telnet_scans(target, report_filename="telnet_scan_report.pdf"):
    # Perform Telnet vulnerability scans if port 23 is open.
    telnet_scans = {
        "telnet_version": ["nmap", "-sV", "--script=banner", "-p", "23", target],
        "telnet_brute_force": ["nmap", "-p", "23", "--script", "telnet-brute", "--script-args", "userdb=myusers.lst,passdb=mypwds.lst,telnet-brute.timeout=8s", target],
        "telnet_ntlm_info": ["nmap", "-p", "23", "--script=telnet-ntlm-info", target],
        "telnet_encryption": ["nmap", "-p", "23", "--script=telnet-encryption", target]
    }

    print("Starting Telnet vulnerability scans...")
    scan_results = []

    for scan_name, scan_command in telnet_scans.items():
        print(f"Running {scan_name}...")
        result = subprocess.run(scan_command, capture_output=True, text=True)
        scan_results.append((scan_name, result.stdout + result.stderr))
    print("Completed Telnet vulnerability scans.")

    # After all scans are done, generate the PDF report
    pdf = FPDF()
    pdf.add_page()
    pdf.set_font("Arial", size=12)
    pdf.cell(200, 10, txt="Telnet Vulnerability Scans Report", ln=True, align='C')

    for scan_name, output in scan_results:
        pdf.ln(10)
        pdf.cell(200, 10, txt=scan_name, ln=True)
        pdf.multi_cell(0, 10, txt=output)

    pdf.output("telnet_scan_report.pdf")