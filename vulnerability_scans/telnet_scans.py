#!/usr/bin/python3

import nmap
import subprocess

def perform_telnet_scans(target):
    # Perform Telnet vulnerability scans if port 23 is open.
    telnet_scans = {
        "telnet_version": ["nmap", "-sV", "--script=banner", "-p", "23", target],
        "telnet_brute_force": ["nmap", "-p", "23", "--script", "telnet-brute", "--script-args", "userdb=myusers.lst,passdb=mypwds.lst,telnet-brute.timeout=8s", target],
        "telnet_ntlm_info": ["nmap", "-p", "23", "--script=telnet-ntlm-info", target],
        "telnet_encryption": ["nmap", "-p", "23", "--script=telnet-encryption", target]
    }

    print("Starting Telnet vulnerability scans...")
    for scan_name, scan_command in telnet_scans.items():
        print(f"Running {scan_name}...")
        subprocess.run(scan_command)
    print("Completed Telnet vulnerability scans.")