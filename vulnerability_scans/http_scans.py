#!/usr/bin/python3

import nmap
import subprocess


def perform_http_scans(target):
    # Perform HTTP vulnerability scans if port 80 is open.
    http_scans = {
        "http_trace_track": ["curl", "-v", "-X", "TRACE", f"{target}:80"],
        "apache_etag_header": ["curl", "-v", "-X", "GET", f"{target}:80"],
        "http_sys_rce": ["curl", "-v", f"{target}:80/", "-H", "Host: irrelevant", "-H", "Range: bytes=0-18446744073709551615"]
    }

    print("Starting HTTP vulnerability scans...")
    for scan_name, scan_command in http_scans.items():
        print(f"Running {scan_name}...")
        subprocess.run(scan_command)
    print("Completed HTTP vulnerability scans.")