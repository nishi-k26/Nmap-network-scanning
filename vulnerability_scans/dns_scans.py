#!/usr/bin/python3

import nmap
import subprocess

def perform_dns_scans(target):
    # Perform DNS vulnerability scans if port 53 is open.
    dns_scans = {
        "dns_bruteforce": ["nmap", "--script=dns-brute", "-p", "53", target],
        "dns_basic_info": ["nmap", "-sV", "--script=dns-info", "-p", "53", target],
        "dns_reverse_lookup": ["nmap", "-sV", "--script=dns-reverse-lookup", "-p", "53", target],
        "dns_srv_enum": ["nmap", "-sV", "--script=dns-srv-enum", "-p", "53", target],
        "dns_zone_transfer": ["nmap", "--script=dns-zone-transfer", "--script-args", "dns-zone-transfer.domain=example.com", "-p", "53", target],
        "dns_cache_snoop": ["nmap", "-sU", "-p", "53", "--script=dns-cache-snoop", target],
        "dns_check_zone": ["nmap", "-sn", "-Pn", "--script=dns-check-zone", "--script-args=dns-check-zone.domain=example.com", "-p", "53", target],
        "dns_recursion": ["nmap", "-Pn", "-sU", "-p", "53", "--script=dns-recursion", target]
    }

    print("Starting DNS vulnerability scans...")
    for scan_name, scan_command in dns_scans.items():
        print(f"Running {scan_name}...")
        subprocess.run(scan_command)
    print("Completed DNS vulnerability scans.")