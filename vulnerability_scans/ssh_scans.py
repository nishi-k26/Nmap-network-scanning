#!/usr/bin/python3

import nmap
import subprocess

def perform_ssh_scans(target):
    # Perform SSH vulnerability scans if port 22 is open.
    ssh_scans = {
        "ssh_banner_grabbing": ["nmap", "-sV", "--script=banner", "-p", "22", target],
        "ssh_weak_algos": ["nmap", "--script=ssh2-enum-algos", "-p", "22", target],
        "ssh_weak_ciphers": ["nmap", "--script=ssh2-enum-algos", "-p", "22", target],
        "ssh_weak_macs": ["nmap", "--script=ssh2-enum-algos", "-p", "22", target],
        "ssh_v1_support": ["nmap", "--script=sshv1", "-p", "22", "-n", target]
    }

    print("Starting SSH vulnerability scans...")
    for scan_name, scan_command in ssh_scans.items():
        print(f"Running {scan_name}...")
        subprocess.run(scan_command)
    print("Completed SSH vulnerability scans.")