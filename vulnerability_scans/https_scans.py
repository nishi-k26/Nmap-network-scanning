#!/usr/bin/python3

import subprocess
from fpdf import FPDF

# List to store the scan results
scan_results = []

def perform_https_scans(target, scan_results, report_filename="https_scan_report.pdf"):
    # Perform HTTPS vulnerability scans if port 443 is open.
    https_scans = {
        "ssl_cert_check": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_protocol_detection": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target],
        "ssl_poodle_vulnerability": ["nmap", "-sV", "--version-light", "--script=ssl-poodle", "-p", "443", target],
        "ssl_heartbleed": ["nmap", "-p", "443", "--script=ssl-heartbleed", target],
        "ssl_dh_params": ["nmap", "--script=ssl-dh-params", target],
        "ssl_weak_rsa_keys": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_weak_hash_algo": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_cert_expiry": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_wrong_hostname": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_ccs_injection": ["nmap", "-p", "443", "--script=ssl-ccs-injection", target],
        "ssl_sweet32": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target],
        "ssl_lucky13": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target],
        "ssl_rc4": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target]
    }

    print("Starting HTTPS vulnerability scans...")
    for scan_name, scan_command in https_scans.items():
        print(f"Running {scan_name}...")
        result = subprocess.run(scan_command, capture_output=True, text=True)
        scan_results.append((scan_name, result.stdout + result.stderr))
    print("Completed HTTPS vulnerability scans.")


# After all scans are done, generate the PDF report
pdf = FPDF()
pdf.add_page()
pdf.set_font("Arial", size=12)
pdf.cell(200, 10, txt="HTTPS Vulnerability Scans Report", ln=True, align='C')

for scan_name, output in scan_results:
    pdf.ln(10)
    pdf.cell(200, 10, txt=scan_name, ln=True)
    pdf.multi_cell(0, 10, txt=output)

pdf.output("https_scan_report.pdf")
print("Report saved as https_scan_report.pdf")
