#!/usr/bin/python3

import nmap
import subprocess

def perform_https_scans(target):
    # Perform HTTPS vulnerability scans if port 443 is open.
    https_scans = {
        "ssl_cert_check": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_protocol_detection": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target],
        "ssl_poodle_vulnerability": ["nmap", "-sV", "--version-light", "--script=ssl-poodle", "-p", "443", target],
        "ssl_heartbleed": ["nmap", "-p", "443", "--script=ssl-heartbleed", target],
        "ssl_dh_params": ["nmap", "--script=ssl-dh-params", target],
        "ssl_weak_rsa_keys": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_weak_hash_algo": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_cert_expiry": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_wrong_hostname": ["nmap", "-sV", "-p", "443", "--script=ssl-cert", target],
        "ssl_ccs_injection": ["nmap", "-p", "443", "--script=ssl-ccs-injection", target],
        "ssl_sweet32": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target],
        "ssl_lucky13": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target],
        "ssl_rc4": ["nmap", "-sV", "--script=ssl-enum-ciphers", "-p", "443", target]
    }

    print("Starting HTTPS vulnerability scans...")
    for scan_name, scan_command in https_scans.items():
        print(f"Running {scan_name}...")
        subprocess.run(scan_command)
    print("Completed HTTPS vulnerability scans.")